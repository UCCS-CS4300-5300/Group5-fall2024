{% extends "home/base_template.html" %}
{% load static %}

{% block splashscreen %}
<div id="splash" class="splash-screen">
    <h1 class="splash-logo">ChitChatty ٩( ᐛ)و</h1>
</div>

<!-- JavaScript to hide the splash screen after a delay -->
<script>
    window.addEventListener("load", function () {
        setTimeout(function () {
            // Start the fade-out effect by adding the splash-hidden class
            const splash = document.getElementById("splash");
            const logo = document.querySelector(".splash-logo");
            splash.classList.add("splash-hidden");

            // Grow and fade out the logo
            logo.style.transform = "scale(1.2)"; // Grow effect
            setTimeout(function () {
                splash.style.display = "none"; // Remove splash screen
            }, 1000); // Delay matches the splash fade-out duration
        }, 1000);  // Delay before starting the splash screen fade-out (1000ms = 1 second)
    });
</script>
{% endblock splashscreen %}

{% block navbar %}
<!-- Navbar Content -->
<nav class="navbar navbar-light floating-navbar" id="navbar">
    <div class="container-fluid d-flex justify-content-between align-items-center">

        <!-- Left Hand Side -->
        <div class="d-flex align-items-center">
            <!-- Flag -->
            <a class="navbar-brand" href="#">
                <img src="{% static 'home/images/Spanish flag.png' %}" width="60" height="50" alt="Spanish flag"
                    style="border-radius: 10px;"> <!-- Flag -->
            </a>
            <!-- Difficulty dropdown -->
            <div class="dropdown ms-1">
                <a class="btn btn-light dropdown-toggle" href="#" role="button" id="dropdownMenuLink1"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    Difficulty
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink1">
                    <li><a class="dropdown-item" href="#" onclick="selectDifficulty('Easy')">Easy</a></li>
                    <li><a class="dropdown-item" href="#" onclick="selectDifficulty('Medium')">Medium</a></li>
                    <li><a class="dropdown-item" href="#" onclick="selectDifficulty('Hard')">Hard</a></li>
                </ul>
            </div>

            <!-- Generate Quiz Button -->
            <div id="generate-quiz-btn" style="display: none;" class="ms-3">
                <form method="POST" action="{% url 'generate_quiz' %}">
                    {% csrf_token %}
                    <input type="hidden" name="difficulty" id="selectedDifficultyInput" value="">
                    <button class="btn btn-warning" type="submit">Confirm</button>
                </form>
            </div>

            <!-- Quiz Generation JS -->
            <script>
                let selectedDifficulty = null;

                function selectDifficulty(difficulty) {
                    selectedDifficulty = difficulty;

                    // Change the button text to reflect the selected difficulty
                    document.getElementById('dropdownMenuLink1').textContent = difficulty;

                    // Set the hidden input's value to the selected difficulty
                    document.getElementById('selectedDifficultyInput').value = difficulty;

                    // Show the "Generate Quiz" button
                    document.getElementById('generate-quiz-btn').style.display = 'block';
                }
            </script>


            <!-- Goal dropdown (hidden for now) -->
            <!-- To change visibility, remove 'style="display: none;'" -->
            <div class="dropdown ms-2" style="display: none;">
                <a class="btn btn-light dropdown-toggle" href="#" role="button" id="dropdownMenuLink2"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    Goal
                </a>
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink2">
                    <li><a class="dropdown-item" href="#">Travel</a></li>
                    <li><a class="dropdown-item" href="#">Fluency</a></li>
                    <li><a class="dropdown-item" href="#">For Fun</a></li>
                </ul>
            </div>
        </div>

        <!-- Logo -->
        <div class="d-flex justify-content-center flex-grow-1">
            <a class="navbar-brand" href="{% url 'index' %}">
                <img src="{% static 'home/images/whiteLogo.png' %}" width="70" height="60" alt="">
            </a>
        </div>

        <!-- Profile Icon -->
        <!-- TEMPORARY: when user is logged in, clicking the person circle is how they log out -->
        <div style="display: flex; align-items: center;">
            {% if user.is_authenticated %}
            <span class="text-white" style="font-weight: bold; margin-right: 10px;">Welcome, {{ user }}</span>
            <a href="{% url 'logout' %}">
                <i class="bi bi-person-circle text-white" style="font-size: 2rem;"></i>
            </a>
            {% else %}
            <a href="{% url 'login-page' %}">
                <i class="bi bi-person-circle text-white" style="font-size: 2rem;"></i>
            </a>
            {% endif %}
        </div>
    </div>
</nav>

{% endblock navbar %}

{% block content %}
<div class="container text-center mt-5">
    <h1 class="display-4" style="color: #31393C;">Welcome to ChitChatty!</h1>
    <p class="lead" style="color: #31393C;">Your go-to platform for enhancing your language skills.</p>
</div>

<!-- Next Quiz section -->
<div class="d-flex justify-content-center align-items-center" style="height: 60vh;">
    <div class="card shadow-lg"
        style="width: 60%; padding: 30px; border: 3px solid #2176FF; border-radius: 15px; position: relative; background: #ffffff;">
        <!-- Next Quiz header -->
        <h1 class="card-title"
            style="position: absolute; top: 20px; left: 30px; font-size: 48px; color: #2176FF; font-weight: bold; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);">
            Next Quiz</h1>

        <div class="d-flex flex-column justify-content-center align-items-center" style="margin-top: 100px;">
            <!-- Display the quiz title and description -->
            <h4 class="text-primary mt-4"
                style="font-size: 32px; color: #33A1FD; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);">{{ quiz_title }}
            </h4>
            <p class="card-text mb-4" style="color: #31393C; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);">{{ quiz_description }}</p>

            <!-- Play Button -->
            {% if quiz_available %}
            <!-- Active play button if quiz is available -->
            <a href="{% url 'quiz' %}" class="btn play-btn rounded-circle d-flex justify-content-center align-items-center"
                style="width: 120px; height: 120px; background: #FDCA40; border: none; box-shadow: 6px 6px 14px rgba(0, 0, 0, 0.3); transition: all 0.3s ease-in-out;">
                <i class="bi bi-play-fill" style="font-size: 60px; color: white; margin-left: 5px;"></i>
            </a>
            {% else %}
            <!-- Disabled play button if no quiz is available -->
            <button class="btn rounded-circle d-flex justify-content-center align-items-center"
                style="width: 120px; height: 120px; background: gray; border: none; box-shadow: 6px 6px 14px rgba(0, 0, 0, 0.3); transition: all 0.3s ease-in-out;" disabled>
                <i class="bi bi-play-fill" style="font-size: 60px; color: white; margin-left: 5px;"></i>
            </button>
            {% endif %}
        </div>
    </div>
</div>
{% endblock content %}